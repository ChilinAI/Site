<!DOCTYPE HTML>
<!--
    Dimension by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang="en">
<head>
    <title>Мои интересы!!!</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
</head>
<body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Header -->
        <header id="header">
            <div class="logo">
                <span class="icon fa-gem"></span>
            </div>
            <div class="content">
                <div class="inner">
                    <h1>Мои интересы</h1>
                    <p>Бесплатное приложение "Мои интересы" для общения пользователей,<br />
                        которые хотят обсуждать статьи администраторов сайтов</p>
                </div>
            </div>
            <nav>
                <ul>
                    <li><a href="#intro">Что это?</a></li>
                    <li><a href="#work">Начать</a></li>
                    <li><a href="#about">Функции</a></li>
                    <li><a href="#contact">Вопросы</a></li>
                    <!--<li><a href="#elements">Elements</a></li>-->
                </ul>
            </nav>
        </header>

        <!-- Main -->
        <div id="main">

            <!-- Intro -->
            <article id="intro">
                <h2 class="major">Что это?</h2>
                <span class="image main"><img src="images/pic01.jpg" alt="" /></span>
                <p>Теперь администраторам сайтов не нужно нанимать команду разработчиков или заказывать создание приложения для своих пользователей. Пользователи могут общаться и обсуждать темы администраторов в этом бесплатном приложении на своем iPhone.</p>
                <p>Темы для обсуждения добавляет администратор сайта в самом приложении. Для этого пройдите быструю регистрацию на следующей <a href="#work">вкладке</a>.</p>
            </article>

            <!-- Work -->
            <article id="work">
                <h2 class="major">Начать</h2>
                <span class="image main"><img src="images/pic02.jpg" alt="" /></span>
                <p>Регистрация очень простая. </p>
                <p>Администратор вводит адрес сайта и свою почту, по которой он будет заходить в приложение. </p>

                <!-- Добавление формы под контентом <div class="container">-->
                <div class="major">
                    <h2>Добавление сайта</h2>
                    <input type="text" id="work-domain" class="input-field" placeholder="Сайт">
                    <input type="email" id="work-email" class="input-field" placeholder="Почта администратора сайта">
                    <button class="button" onclick="addDomainAdmin()">Добавить</button>
                    <div id="work-message" class="message">Сайт успешно добавлен!</div>
                </div>
                <br>
                <p>Теперь Администратор должен добавить себе на сайт <a href="email.html" download>нижерасположенную форму</a> регистрации для пользователей в приложении. Форма доступна по <a href="admin.html" download>ссылке</a>.</p>
                
                <div class="major">
                    <h2>Регистрация в приложении</h2>
                    <input type="email" id="email" class="input-field" placeholder="Почта">
                    <button class="button" onclick="registerUser()">Отправить</button>
                    <div id="message" class="message"></div>
                </div>
                
            </article>

            <!-- About -->
            <article id="about">
                <h2 class="major">Функции</h2>
                <span class="image main"><img src="images/pic03.jpg" alt="" /></span>
                <p>В приложении есть несколько вкладок:</p>
                <ul class="alt">
                    <li><u>Admin</u> - вкладка доступна только администраторам. На которой они могут добавлять статьи для обсуждения пользователями. А также добавлять почту пользователей, по которой они будут заходить в приложение.</li>
                    <li><u>Home</u> - лента статей, добавленная администратором. Под лентой располагается чат.</li>
                    <li><u>Сообщения</u> - на этой вкладке пользователи видят сообщения от других участников.</li>
                    <li><u>Профиль</u> - настройки пользователя</li>
                </ul>
            </article>

            <!-- Contact -->
            <article id="contact">
                <h2 class="major">Вопросы</h2>
                <p>Приложение новое. Вопросов нет.</p>
                <p>Вскоре, ответы на вопросы можно будет найти на этой вкладке.</p>
            </article>
        </div>

        <!-- Footer -->
        <footer id="footer">
            <p class="copyright">&copy; Untitled. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
        </footer>
    </div>

    <!-- BG -->
    <div id="bg"></div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script type="module">
        // Импорт необходимых функций из Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";

        // Ваша конфигурация веб-приложения Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBMsTmgX69DGy7UFI8mv1wn7xBM4QTC3Ss",
            authDomain: "chilin1.firebaseapp.com",
            projectId: "chilin1",
            storageBucket: "chilin1.appspot.com",
            messagingSenderId: "904851088567",
            appId: "1:904851088567:web:7e5272ef186b286573d932"
        };

        // Инициализация Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function addDomainAdmin() {
            const domain = document.getElementById('work-domain').value;
            const email = document.getElementById('work-email').value;
            console.log("Attempting to add domain admin:", { domain, email });
            try {
                await setDoc(doc(db, 'DomainAdmins', domain), {
                    nameAdmin: email
                });
                console.log("Document successfully written!");
                // Очистить поля ввода
                document.getElementById('work-domain').value = '';
                document.getElementById('work-email').value = '';
                // Показать сообщение
                const messageElem = document.getElementById('work-message');
                messageElem.style.display = 'block';
                setTimeout(() => {
                    messageElem.style.display = 'none';
                }, 33000);
            } catch (error) {
                console.error('Error writing document: ', error);
            }
        }

        async function registerUser() {
            const email = document.getElementById('email').value;
            const domain = window.location.hostname;
            console.log("Attempting to register user:", { domain, email });
            try {
                // Создание документа пользователя с полем domain
                const userDocRef = doc(db, 'Users', email);
                await setDoc(userDocRef, {
                    domain: domain
                });
                console.log("Document successfully written!");
                // Очистить поле ввода
                document.getElementById('email').value = '';
                // Показать сообщение
                const messageElem = document.getElementById('message');
                messageElem.innerHTML = `Вы зарегистрированы для сайта: <span style="font-size: 1.5em; font-weight: bold;">${domain}</span>`;
                messageElem.style.display = 'block'; // Убедитесь, что сообщение отображается
                setTimeout(() => {
                    messageElem.style.display = 'none';
                }, 55000); // Сообщение исчезает через 55 секунд
            } catch (error) {
                console.error('Error writing document: ', error);
            }
        }

        // Добавление функций в глобальный объект window
        window.addDomainAdmin = addDomainAdmin;
        window.registerUser = registerUser;
    </script>
    
</body>
    
    
</html>